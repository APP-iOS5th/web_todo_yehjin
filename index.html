<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
  <style>
    .todo-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: bold; 
    }

    .todo-item span {
      margin-right: auto;
    }

    .todo-date {
      font-size: 0.75rem; 
      color: #6c757d; 
    }

    .list-group-item {
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); 
      margin-bottom: 5px; 
      border-radius: 10px; 
    }

    .todo-checkbox {
      margin-right: 10px;
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
      width: 25px;
      height: 25px;
      background-color: #eee;
      border-radius: 5px;
    }

    .todo-checkbox:checked {
      background-color: #0d6efd;
    }

    .todo-checkbox:checked:after {
      content: '\\2713';
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
    }

    .todo-box {
        position: relative;
        padding: 20px;
        border: 1px solid #ddd; /* 상자의 테두리 */
        border-radius: 10px; /* 상자의 모서리를 둥글게 */
        background-color: #f9f9f9; /* 상자의 배경색 */
    }

    .todo-date-time {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 0.75rem;
        color: #6c757d;
    }

  
    
  </style>
  <title>To-Do List</title>
</head>

<body>

  <div class="container">
    <div class="row justify-content-center">
      <div class="col-6">
        <h1 class="mt-5 text-center">To-Do List</h1>
        <!-- 입력부분 -->
        <div class="input-group mb-3 mt-3">
          <input type="text" class="form-control" id="todoInput" placeholder="New task">
          <button class="btn btn-primary" id="addTodo">+</button>
          <div class="todo-box">
            <div class="todo-date-time">00월 00일 00:00</div> 
            <ul class="list-group" id="todoList"></ul>
          </div>
        
        </div>

        

        <!-- 리스트 -->
        <ul class="list-group" id="todoList">
        </ul>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      loadTodos();
    });

    document.getElementById('addTodo').addEventListener('click', function() {
      var value = document.getElementById('todoInput').value;
      if (value) {
        addTodo(value);
        document.getElementById('todoInput').value = '';
        storeTodos();
      }
    });
    document.addEventListener('DOMContentLoaded', function() {
        loadTodos();
        updateDateTime();
    });

    function updateDateTime() {
        var now = new Date();
        var dateString = now.getFullYear() + '년 ' + (now.getMonth() + 1) + '월 ' + now.getDate() + '일 ';
        var timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
        document.querySelector('.todo-date-time').textContent = dateString + timeString;
  
     // 매분마다 시간 업데이트
     setTimeout(updateDateTime, 60000 - (now.getSeconds() * 1000 + now.getMilliseconds()));
    }


    function addTodo(text) {
      var list = document.getElementById('todoList');
      var item = document.createElement('li');
      item.classList.add('list-group-item', 'todo-item');

      var checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.classList.add('todo-checkbox');

      var textSpan = document.createElement('span');
      textSpan.innerText = text;

      item.appendChild(checkbox);
      item.appendChild(textSpan);

      list.appendChild(item);

      checkbox.addEventListener('change', function() {
        if (this.checked) {
          textSpan.style.textDecoration = "line-through";
        } else {
          textSpan.style.textDecoration = "none";
        }
        storeTodos();
      });
    }

    function storeTodos() {
      var todos = [];
      var todoList = document.getElementById('todoList').children;
      for (var i = 0; i < todoList.length; i++) {
        todos.push({
          text: todoList[i].getElementsByTagName('span')[0].innerText,
          completed: todoList[i].getElementsByTagName('input')[0].checked
        });
      }
      localStorage.setItem('todos', JSON.stringify(todos));
    }

    function loadTodos() {
      var todos = JSON.parse(localStorage.getItem('todos'));
      if (todos) {
        todos.forEach(function(todo) {
          addTodoWithStatus(todo.text, todo.completed);
        });
      }
    }

    function addTodoWithStatus(text, completed) {
      addTodo(text);
      var lastItemCheckbox = document.getElementById('todoList').lastChild.getElementsByTagName('input')[0];
      lastItemCheckbox.checked = completed;
      if (completed) {
        document.getElementById('todoList').lastChild.getElementsByTagName('span')[0].style.textDecoration = "line-through";
      }
    }
  </script>
</body>

</html>
